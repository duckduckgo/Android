name: 'Assign Asana Task'
description: 'Assign an Asana task to a specified user ID'
inputs:
  task_id:
    description: 'ID of the task to assign'
    required: true
  user_id:
    description: 'User ID to assign the task to'
    required: true
  asana_token:
    description: 'Asana Personal Access Token'
    required: true
runs:
  using: 'composite'
  steps:
    - name: Assign Task in Asana
      shell: bash
      run: |      
        task_id="${{ inputs.task_id }}"
        user_id="${{ inputs.user_id }}"
        asana_token="${{ inputs.asana_token }}"

        echo "Assigning task ID $task_id to user ID $user_id"

        # Assign the task to the user
        response=$(curl -s -X PUT "https://app.asana.com/api/1.0/tasks/${task_id}" \
          -H "Authorization: Bearer ${asana_token}" \
          -H "Content-Type: application/json" \
          -d "{\"assignee\": \"${user_id}\"}")

        # Check if the assignment was successful
        status=$(echo $response | jq -r '.errors')

        if [ "$status" == "null" ]; then
          echo "Task $task_id successfully assigned to user $user_id."
        else
          echo "Failed to assign task: $status"
          exit 1
        fi
