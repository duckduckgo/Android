---
alwaysApply: true
---
# Android Design System (ADS)

The DuckDuckGo Android Design System lives in `android-design-system/design-system/`. Always use ADS components instead of raw Android/Material widgets. Lint rules will break the build if you bypass ADS.

---

## Core Principle

**Never use raw platform widgets** (`Button`, `TextView`, `Switch`, `AlertDialog`, `BottomSheetDialog`, etc.) — lint detects and fails on these. Always use the ADS equivalent.

---

## Package

All components live under `com.duckduckgo.common.ui.view.*`. Use this package in both Kotlin code and XML layouts.

---

## Buttons

Five variants — pick by intent, never by style:

| Variant | Class | Use for |
|---|---|---|
| Primary | `DaxButtonPrimary` | Main CTA |
| Secondary | `DaxButtonSecondary` | Secondary action |
| Ghost | `DaxButtonGhost` | Tertiary / low-emphasis |
| Ghost Alt | `DaxButtonGhostAlt` | Ghost on alternate background |
| Destructive | `DaxButtonDestructive` | Irreversible/dangerous action |
| Destructive Ghost | `DaxButtonGhostDestructive` | Destructive low-emphasis |

```xml
<com.duckduckgo.common.ui.view.button.DaxButtonPrimary
    android:id="@+id/submitButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/submit"
    app:buttonSize="large" />
```

**Accepted attributes:** `android:text`, `android:enabled`, `app:icon`, `app:buttonSize="large|small"` (default: small)

**Forbidden attributes (build breaks):** `android:textStyle`, `android:textColor`, `android:textAppearance`, `android:tint`, `android:textAllCaps`, `android:layout_height`, `style`

**Button spacing:** Use `@dimen/keyline_1` (4dp) between buttons, not 16dp — buttons have 6dp insets top/bottom, so 4+6+6 = 16dp visual spacing.

---

## Text — DaxTextView

One component for all text. Never use `TextView` or set `android:textAppearance` directly.

```xml
<com.duckduckgo.common.ui.view.text.DaxTextView
    android:id="@+id/title"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="@string/page_title"
    app:typography="h1"
    app:textType="primary" />
```

**`app:typography` values:**
`title` · `h1` · `h2` · `h3` · `h4` · `h5` · `body1` (default) · `body1_bold` · `body1_mono` · `body2` · `body2_bold` · `button` · `caption` · `caption_allCaps`

**`app:textType` values:** `primary` (default) · `secondary`

**Forbidden attributes (build breaks):** `android:textAppearance`, `android:textAllCaps`, `android:tint`, `android:textSize`, `android:textStyle`, `android:fontFamily`

**Typography specs:**
```
title         32sp bold,   36sp line height
h1            24sp bold,   30sp line height
h2            20sp medium, 24sp line height, 0.3sp letter spacing
h3            16sp medium, 21sp line height
h4            14sp medium, 20sp line height
h5            13sp medium, 16sp line height
body1         16sp regular, 20sp line height
body1_bold    16sp bold,   20sp line height
body1_mono    16sp regular, Roboto Mono, 20sp line height
body2         14sp regular, 18sp line height
body2_bold    14sp bold,   18sp line height
button        15sp bold,   20sp line height
caption       12sp regular, 16sp line height
caption_allCaps  12sp regular, uppercase
```

---

## Text Input — DaxTextInput

```xml
<com.duckduckgo.common.ui.view.text.DaxTextInput
    android:id="@+id/emailInput"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:hint="@string/email_hint"
    app:type="single_line"
    app:editable="true" />
```

**`app:type`:** `single_line` · `multi_line` · `password`

**Public API:**
```kotlin
var text: String
var hint: String
var error: String?   // show field-level validation errors only (not network errors)
var isEditable: Boolean
fun addTextChangedListener(textWatcher: TextWatcher)
fun removeTextChangedListener(textWatcher: TextWatcher)
fun onAction(actionHandler: (Action) -> Unit)
fun setEndIcon(@DrawableRes endIconRes: Int, contentDescription: String? = null)
fun removeEndIcon()
fun doOnTextChanged(action: (CharSequence?, Int, Int, Int) -> Unit)
```

Use `error` only for invalid user input. For network/external errors, use a Snackbar instead.

---

## Switch — DaxSwitch

```xml
<com.duckduckgo.common.ui.view.DaxSwitch
    android:id="@+id/featureSwitch"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />
```

Use the extension to change state without triggering the listener:
```kotlin
switch.quietlySetIsChecked(newCheckedState, changeListener)
```

---

## List Items

Three main variants:

### OneLineListItem
48dp height (56dp with large icon).
```xml
<com.duckduckgo.common.ui.view.listitem.OneLineListItem
    android:id="@+id/item"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:primaryText="@string/item_title"
    app:leadingIconImageBackground="circular" />
```

### TwoLineListItem
56dp height (64dp with large icon).
```xml
<com.duckduckgo.common.ui.view.listitem.TwoLineListItem
    android:id="@+id/item"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:primaryText="@string/title"
    app:secondaryText="@string/subtitle" />
```

### SectionHeaderListItem
44dp height. Introduces a new section.
```xml
<com.duckduckgo.common.ui.view.listitem.SectionHeaderListItem
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:primaryText="@string/section_header"
    app:showOverflowMenu="false" />
```

**Common list item API:**
```kotlin
fun setPrimaryText(title: CharSequence?)
fun setSecondaryText(title: CharSequence?)
fun setLeadingIconResource(@DrawableRes idRes: Int)
fun setLeadingIconBackgroundType(type: ImageBackground)  // None, Circular, Rounded
fun setLeadingIconSize(imageSize: IconSize)              // Small, Medium, Large, ExtraLarge
fun setTrailingIconResource(@DrawableRes idRes: Int)
fun showSwitch()
fun setIsChecked(isChecked: Boolean)
fun setOnCheckedChangeListener(listener: OnCheckedChangeListener)
fun setClickListener(onClick: () -> Unit)
fun hideLeadingItems()
fun hideTrailingItems()
```

**`app:leadingIconImageBackground`:** `none` · `circular` · `rounded`

---

## Dividers

```xml
<!-- Horizontal -->
<com.duckduckgo.common.ui.view.divider.HorizontalDivider
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:fullWidth="false"
    app:defaultPadding="true" />

<!-- Vertical -->
<com.duckduckgo.common.ui.view.divider.VerticalDivider
    android:layout_width="wrap_content"
    android:layout_height="match_parent" />
```

A lint rule flags `View` used as a divider — always use the ADS divider components.

---

## Dialogs

Never use `AlertDialog` or `MaterialAlertDialog` — lint prevents it.

### TextAlertDialogBuilder — standard alert
```kotlin
TextAlertDialogBuilder(requireContext())
    .setTitle(R.string.confirm_title)
    .setMessage(R.string.confirm_message)
    .setPositiveButton(R.string.yes)
    .setNegativeButton(R.string.cancel)
    .addEventListener(object : TextAlertDialogBuilder.EventListener() {
        override fun onPositiveButtonClicked() { /* action */ }
    })
    .show()
```

### StackedAlertDialogBuilder — stacked buttons
```kotlin
StackedAlertDialogBuilder(requireContext())
    .setTitle(R.string.title)
    .setMessage(R.string.message)
    .setStackedButtons(listOf(
        StackedAlertDialogBuilder.StackedButton(R.string.option_a) { /* */ },
        StackedAlertDialogBuilder.StackedButton(R.string.option_b) { /* */ },
    ))
    .show()
```

### RadioListAlertDialogBuilder — single selection
```kotlin
RadioListAlertDialogBuilder(requireContext())
    .setTitle(R.string.title)
    .setOptions(options, selectedIndex)
    .setPositiveButton(R.string.ok)
    .setNegativeButton(R.string.cancel)
    .addEventListener(...)
    .show()
```

---

## Bottom Sheets

Never use raw `BottomSheetDialog` or `BottomSheetDialogFragment` without the ADS style — lint prevents it.

For custom bottom sheets use:
```kotlin
// BottomSheetDialog — apply the ADS style
BottomSheetDialog(context, com.duckduckgo.mobile.android.R.style.Widget_DuckDuckGo_FireDialog)

// BottomSheetDialogFragment — extend normally (style is inherited from theme)
class MyBottomSheet : BottomSheetDialogFragment() { ... }
```

Use `ActionBottomSheetDialog` or `PromoBottomSheetDialog` for the two standard patterns.

---

## Menu Components

### MenuItemView — browser menu entries
```xml
<com.duckduckgo.common.ui.view.MenuItemView
    android:id="@+id/newTabMenuItem"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:iconDrawable="@drawable/ic_add_16"
    app:primaryText="@string/new_tab" />
```

### PopupMenuItemView — popup/context menus
```xml
<com.duckduckgo.common.ui.view.PopupMenuItemView
    android:id="@+id/deleteItem"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:primaryText="@string/delete"
    app:primaryTextType="destructive"
    app:trailingIcon="@drawable/ic_trash_16" />
```

---

## Skeleton / Loading State

Wrap `SkeletonView` elements in `ShimmerFrameLayout`:
```xml
<com.facebook.shimmer.ShimmerFrameLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content">
    <include layout="@layout/view_entry_skeleton" />
</com.facebook.shimmer.ShimmerFrameLayout>
```

```xml
<!-- view_entry_skeleton.xml -->
<com.duckduckgo.common.ui.view.SkeletonView
    android:layout_width="40dp"
    android:layout_height="40dp" />
```

Never set `android:background="@drawable/background_skeleton"` on SkeletonView — lint prevents it.

---

## NotifyMeView

Self-hiding component that shows a notification prompt when system notifications are disabled.
```xml
<com.duckduckgo.common.ui.view.notifyme.NotifyMeView
    android:id="@+id/notifyMe"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:dismissIcon="true"
    app:contentOrientation="start"
    app:primaryText="@string/notify_title"
    app:secondaryText="@string/notify_body" />
```

---

## Colors

**Never use `@color/` references directly in XML** — lint breaks the build. Always use `?attr/daxColor*` theme attributes.

```xml
<!-- WRONG -->
android:textColor="@color/white"

<!-- CORRECT -->
android:textColor="?attr/daxColorPrimaryText"
```

**Key color attributes:**

| Attribute | Use for |
|---|---|
| `?attr/daxColorBackground` | Screen background |
| `?attr/daxColorSurface` | Toolbars, navigation, dialogs |
| `?attr/daxColorContainer` | Object containers (favicon bg) |
| `?attr/daxColorPrimaryText` | Primary text |
| `?attr/daxColorSecondaryText` | Secondary/supporting text |
| `?attr/daxColorTertiaryText` | Hint/placeholder text |
| `?attr/daxColorPrimaryIcon` | Primary icon tint |
| `?attr/daxColorSecondaryIcon` | Secondary icon tint |
| `?attr/daxColorAccentBlue` | Primary accent / CTAs |
| `?attr/daxColorDestructive` | Destructive actions |
| `?attr/daxColorLines` | Dividers |

For theme-responsive icons set `android:fillColor="?attr/daxColorPrimaryIcon"`.

In Kotlin: `context.getColorFromAttr(R.attr.daxColorPrimaryText)`

---

## Spacing / Dimensions

Always use keylines — never hardcode arbitrary dp values:

| Resource | Value | Common use |
|---|---|---|
| `@dimen/keyline_0` | 2dp | Fine adjustments |
| `@dimen/keyline_1` | 4dp | Between buttons |
| `@dimen/keyline_2` | 8dp | Tight spacing |
| `@dimen/keyline_3` | 12dp | Medium spacing |
| `@dimen/keyline_4` | 16dp | Screen edge → content |
| `@dimen/keyline_5` | 24dp | Dialog edge → content |
| `@dimen/keyline_6` | 32dp | Large gaps |
| `@dimen/keyline_7` | 48dp | Extra large |

---

## Activities and Fragments

Extend ADS base classes to get theming for free:
```kotlin
class MyActivity : DuckDuckGoActivity()
class MyFragment : DuckDuckGoFragment()
```

---

## Lint Rules (build-breaking)

These are enforced at compile time:

| Rule | What it prevents |
|---|---|
| `NoStyleAppliedToDesignSystemComponentDetector` | `style=` on any ADS component |
| `ColorAttributeInXmlDetector` | `@color/` references in XML |
| `DeprecatedAndroidWidgetsUsedInXmlDetector` | Raw `Button`, `TextView`, `SwitchView` |
| `DaxButtonStylingDetector` | Forbidden attributes on `DaxButton*` |
| `DaxTextViewStylingDetector` | Forbidden attributes on `DaxTextView` |
| `MissingDividerDetector` | Plain `View` used as divider |
| `NoAlertDialogDetector` | `AlertDialog` / `MaterialAlertDialog` |
| `NoBottomSheetDialogDetector` | Raw `BottomSheetDialog` without ADS style |
| `SkeletonViewBackgroundDetector` | `background_skeleton` drawable on `SkeletonView` |
| `WrongStyleDetector` | Styles not prefixed `Widget.DuckDuckGo.` |

---

## Icons

- Source icons from the internal DDG Icons repository at https://dub.duckduckgo.com/duckduckgo/Icons
- Name SVG files as close as possible to the original `.svg` name
- Import as vector asset in Android Studio
- If used in only one feature, keep in that feature's `-impl` module, not `common-ui`
- For theme-responsive icons: `android:fillColor="?attr/daxColorPrimaryIcon"`

**When a new icon is needed:** ask the user for the icon name, then fetch it directly from https://dub.duckduckgo.com/duckduckgo/Icons and use it. Do not guess icon names or skip this step.
