appId: com.duckduckgo.mobile.android
name: "Split omnibar test"
tags:
  - omnibarTest
  - releaseTest
---
- retry:
    maxRetries: 3
    commands:
      - launchApp:
          clearState: true
          stopApp: true
      - runFlow: ../shared/skip_all_onboarding.yaml
      - runFlow: ./shared/omnibar_select_split_type.yaml

# verify that autocomplete suggestions are shown when typing
- tapOn:
    id: "omnibarTextInput"
    optional: true
- inputText: "reddit"
- assertVisible:
    id: "autoCompleteSuggestionsList"
- assertVisible:
    text: "reddit.com"
    childOf:
      id: "autoCompleteSuggestionsList"

# verify that submitting a search query opens SERP
- pressKey: Enter
- assertVisible:
    id: "browserLayout"
- assertVisible:
    text: "reddit"
    childOf:
      id: "browserLayout"

# add the page to favorites (for future assertions)
- runFlow: ../shared/browser_screen/click_on_menu_button.yaml
- tapOn:
    text: "add bookmark"
- runFlow: ../shared/browser_screen/click_on_menu_button.yaml
- tapOn:
    text: "bookmarks"
- tapOn:
    id: "com.duckduckgo.mobile.android:id/trailingIcon"
    index: 0
- tapOn:
    text: "add to favorites"
- action: back

# verify that clearing the text and submitting a URL opens the web page
- tapOn:
    id: "omnibarTextInput"
- tapOn:
    id: "clearTextButton"
- inputText: "eff.org"
- pressKey: Enter
- assertVisible:
    id: "browserLayout"
- extendedWaitUntil:
    visible:
      text: "https://www.eff.org/"
      childOf:
        id: "omnibarTextInput"
    timeout: 10000
- assertVisible:
    text: "https://www.eff.org/"
    childOf:
      id: "omnibarTextInput"

# verify that tapping on a favorite opens the web page (SERP in this case)
- tapOn:
    id: "omnibarTextInput"
- tapOn:
    id: "quickAccessFavicon"
    childOf:
      id: "focusedFavourites"
- assertVisible:
    id: "browserLayout"
- assertVisible:
    text: "reddit"
    childOf:
      id: "omnibarTextInput"
- assertVisible:
    text: "reddit"
    childOf:
      id: "browserLayout"
