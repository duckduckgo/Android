appId: com.duckduckgo.mobile.android
name: "DuckPlayer: Accept to use Duck Player from YouTube overlay and verify it loads"
tags:
  - duckplayerlocal
---
- retry:
    maxRetries: 0
    commands:
      - launchApp:
          clearState: true

      - runFlow: ../shared/skip_all_onboarding.yaml
      - runFlow: common/load_youtube_video.yaml
      
      # Assert the DuckPlayer prompt has expected content
      - assertVisible:
          text: "Turn On Duck Player"
      - assertVisible:
          text: "No Thanks"
      
      # Accept the DuckPlayer prompt
      - tapOn:
          text: "Turn On Duck Player"
      
      # Wait for Duck Player to load
      - extendedWaitUntil:
          visible:
              text: "duck://player/.*"
          timeout: 5000
      
      # Core assertion: Duck Player is now active (confirmed by extendedWaitUntil above)
      # Overlay not shown
      - runFlow: common/assert_overlay_not_shown.yaml
 